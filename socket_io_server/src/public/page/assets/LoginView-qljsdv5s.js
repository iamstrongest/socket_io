import{q as y,u as $,o as d,c as f,a as e,v as w,x as p,y as u,z as x,B as k,r as V,f as D,C as I,t as R,j as b,D as S,K as h}from"./index-BJBM8RCy.js";import{l as C,r as F}from"./user-SyG9M8Is.js";import{_}from"./_plugin-vue_export-helper-DlAUqK2U.js";const T={class:"form_container"},U={class:"form_col"},A={for:"email"},B={class:"form_col"},L={for:"password"},z={__name:"Login",setup(g){const l=y({password:"",email:""}),o=$(),r=async()=>{try{const{data:n}=await C(l),{data:a}=n;l.email="",l.password="",n.code===200&&confirm(n.message)&&(localStorage.setItem("token",a.token),o.push("/"))}catch(n){console.error("登录失败:",n)}};return(n,a)=>(d(),f("div",T,[e("form",{onSubmit:x(r,["prevent"])},[e("div",U,[e("label",A,[a[2]||(a[2]=e("span",null,"邮箱: ",-1)),a[3]||(a[3]=w()),p(e("input",{type:"email","onUpdate:modelValue":a[0]||(a[0]=t=>l.email=t),name:"email",id:"email",placeholder:"输入邮箱"},null,512),[[u,l.email]])])]),e("div",B,[e("label",L,[a[4]||(a[4]=e("span",null,"密码: ",-1)),a[5]||(a[5]=w()),p(e("input",{type:"password","onUpdate:modelValue":a[1]||(a[1]=t=>l.password=t),name:"password",id:"password",placeholder:"输入密码"},null,512),[[u,l.password]])])]),a[6]||(a[6]=e("div",{class:"form_col submit"},[e("label",{for:"submit"},[e("button",{type:"submit",name:"submit"},"登录")])],-1))],32)]))}},c=_(z,[["__scopeId","data-v-98cfbdfd"]]),N={class:"form_container"},Z={class:"form_col file"},j={for:"file",class:"flie_label"},K=["src"],M={class:"form_col"},P={for:"password"},q={class:"form_col"},E={for:"email"},G={class:"form_col"},H={for:"password"},J={__name:"Register",setup(g){const l=k("file"),o=y({password:"",email:"",username:""}),r=V(),n=async()=>{const t=new FormData,s=l.value.files[0];if(!(s&&/^(image\/jpeg|image\/png|image\/gif|image\/bmp|image\/webp)$/.test(s.type))){alert("Valid image file.");return}if(!/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(o.email)){alert("Invalid email address.");return}if(o.password.length<6){alert("注册密码不能少于6位数");return}if(o.username.length==0){alert("注册昵称不能为空");return}t.append("file",s),t.append("fileName",s.name.split(".")[0]),t.append("timestamp",Date.now()),t.append("email",o.email),t.append("password",o.password),t.append("username",o.username);try{const m=await F(t);console.log("上传成功:",m.data),o.email="",o.password="",o.username=""}catch(m){console.error("上传失败:",m)}},a=t=>{const s=t.target.files[0],i=new FileReader;i.onload=function(v){const m=v.target.result;r.value=m},i.readAsDataURL(s)};return(t,s)=>(d(),f("div",N,[e("form",{onSubmit:x(n,["prevent"])},[e("div",Z,[e("label",j,[s[3]||(s[3]=e("span",null,"上传图片: ",-1)),s[4]||(s[4]=e("div",null,[e("svg",{class:"icon","aria-hidden":"true"},[e("use",{"xlink:href":"#icon-shangchuantouxiang"})])],-1)),e("input",{type:"file",name:"file",ref:"file",id:"file",onChange:a},null,544),r.value?(d(),f("img",{key:0,src:r.value,alt:"预览"},null,8,K)):D("",!0)])]),e("div",M,[e("label",P,[s[5]||(s[5]=e("span",null,"昵称: ",-1)),p(e("input",{type:"text","onUpdate:modelValue":s[0]||(s[0]=i=>o.username=i),id:"password",name:"password",placeholder:"输入昵称"},null,512),[[u,o.username]])])]),e("div",q,[e("label",E,[s[6]||(s[6]=e("span",null,"注册邮箱: ",-1)),p(e("input",{type:"email","onUpdate:modelValue":s[1]||(s[1]=i=>o.email=i),id:"email",name:"email",placeholder:"输入邮箱认证"},null,512),[[u,o.email]])])]),e("div",G,[e("label",H,[s[7]||(s[7]=e("span",null,"登录密码: ",-1)),p(e("input",{type:"password","onUpdate:modelValue":s[2]||(s[2]=i=>o.password=i),id:"password",name:"password",placeholder:"输入密码"},null,512),[[u,o.password]])])]),s[8]||(s[8]=e("div",{class:"form_col submit"},[e("label",{for:"submit"},[e("button",{type:"submit",name:"submit",id:"submit"},"注册")])],-1))],32)]))}},O=_(J,[["__scopeId","data-v-6f9a460f"]]),Q={class:"login_view"},W={__name:"LoginView",setup(g){const l=I(c),o=V("注册");function r(){l.value===c?(o.value="登录",l.value=O):(o.value="注册",l.value=c)}return(n,a)=>(d(),f("div",Q,[e("button",{class:"toggle",type:"button",onClick:r},R(o.value),1),(d(),b(h,null,[(d(),b(S(l.value)))],1024))]))}},se=_(W,[["__scopeId","data-v-f7781aac"]]);export{se as default};
