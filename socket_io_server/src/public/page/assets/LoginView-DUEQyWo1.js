import{s as y,u as $,o as d,c as f,a as e,x as w,y as p,z as u,A as x,k,i as V,b as I,B as R,t as D,j as b,C as S,K as h}from"./index-DCXIXEj8.js";import{l as A,r as C}from"./user-giQHEvsq.js";import{_}from"./_plugin-vue_export-helper-DlAUqK2U.js";const F={class:"form_container"},T={class:"form_col"},U={for:"email"},B={class:"form_col"},L={for:"password"},z={__name:"Login",setup(g){const l=y({password:"",email:""}),o=$(),r=async()=>{try{const{data:n}=await A(l),{data:t}=n;l.email="",l.password="",n.code===200&&confirm(n.message)&&(localStorage.setItem("token",t.token),o.push("/"))}catch(n){console.error("登录失败:",n)}};return(n,t)=>(d(),f("div",F,[e("form",{onSubmit:x(r,["prevent"])},[e("div",T,[e("label",U,[t[2]||(t[2]=e("span",null,"邮箱: ",-1)),t[3]||(t[3]=w()),p(e("input",{type:"email","onUpdate:modelValue":t[0]||(t[0]=a=>l.email=a),name:"email",id:"email",placeholder:"输入邮箱"},null,512),[[u,l.email]])])]),e("div",B,[e("label",L,[t[4]||(t[4]=e("span",null,"密码: ",-1)),t[5]||(t[5]=w()),p(e("input",{type:"password","onUpdate:modelValue":t[1]||(t[1]=a=>l.password=a),name:"password",id:"password",placeholder:"输入密码"},null,512),[[u,l.password]])])]),t[6]||(t[6]=e("div",{class:"form_col submit"},[e("label",{for:"submit"},[e("button",{type:"submit",name:"submit"},"登录")])],-1))],32)]))}},c=_(z,[["__scopeId","data-v-98cfbdfd"]]),N={class:"form_container"},Z={class:"form_col file"},j={for:"file",class:"flie_label"},K=["src"],M={class:"form_col"},P={for:"password"},E={class:"form_col"},q={for:"email"},G={class:"form_col"},H={for:"password"},J={__name:"Register",setup(g){const l=k("file"),o=y({password:"",email:"",username:""}),r=V(),n=async()=>{const a=new FormData,s=l.value.files[0];if(!(s&&/^(image\/jpeg|image\/png|image\/gif|image\/bmp|image\/webp)$/.test(s.type))){alert("Valid image file.");return}if(!/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(o.email)){alert("Invalid email address.");return}if(o.password.length<6){alert("注册密码不能少于6位数");return}if(o.username.length==0){alert("注册昵称不能为空");return}a.append("file",s),a.append("fileName",s.name.split(".")[0]),a.append("timestamp",Date.now()),a.append("email",o.email),a.append("password",o.password),a.append("username",o.username);try{const m=await C(a);console.log("上传成功:",m.data),o.email="",o.password="",o.username=""}catch(m){console.error("上传失败:",m)}},t=a=>{const s=a.target.files[0],i=new FileReader;i.onload=function(v){const m=v.target.result;r.value=m},i.readAsDataURL(s)};return(a,s)=>(d(),f("div",N,[e("form",{onSubmit:x(n,["prevent"])},[e("div",Z,[e("label",j,[s[3]||(s[3]=e("span",null,"上传文件: ",-1)),s[4]||(s[4]=e("div",null,[e("svg",{class:"icon","aria-hidden":"true"},[e("use",{"xlink:href":"#icon-shangchuantouxiang"})])],-1)),e("input",{type:"file",name:"file",ref:"file",id:"file",onChange:t},null,544),r.value?(d(),f("img",{key:0,src:r.value,alt:"预览"},null,8,K)):I("",!0)])]),e("div",M,[e("label",P,[s[5]||(s[5]=e("span",null,"昵称: ",-1)),p(e("input",{type:"text","onUpdate:modelValue":s[0]||(s[0]=i=>o.username=i),id:"password",name:"password",placeholder:"输入昵称"},null,512),[[u,o.username]])])]),e("div",E,[e("label",q,[s[6]||(s[6]=e("span",null,"注册邮箱: ",-1)),p(e("input",{type:"email","onUpdate:modelValue":s[1]||(s[1]=i=>o.email=i),id:"email",name:"email",placeholder:"输入邮箱认证"},null,512),[[u,o.email]])])]),e("div",G,[e("label",H,[s[7]||(s[7]=e("span",null,"登录密码: ",-1)),p(e("input",{type:"password","onUpdate:modelValue":s[2]||(s[2]=i=>o.password=i),id:"password",name:"password",placeholder:"输入密码"},null,512),[[u,o.password]])])]),s[8]||(s[8]=e("div",{class:"form_col submit"},[e("label",{for:"submit"},[e("button",{type:"submit",name:"submit",id:"submit"},"注册")])],-1))],32)]))}},O=_(J,[["__scopeId","data-v-49afe472"]]),Q={class:"login_view"},W={__name:"LoginView",setup(g){const l=R(c),o=V("注册");function r(){l.value===c?(o.value="登录",l.value=O):(o.value="注册",l.value=c)}return(n,t)=>(d(),f("div",Q,[e("button",{class:"toggle",type:"button",onClick:r},D(o.value),1),(d(),b(h,null,[(d(),b(S(l.value)))],1024))]))}},se=_(W,[["__scopeId","data-v-808ee57a"]]);export{se as default};
