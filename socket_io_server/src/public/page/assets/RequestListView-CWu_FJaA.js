import{a as k,_ as b,u as h,s as $}from"./_plugin-vue_export-helper-D_52YD_W.js";import{o as i,c,a as e,f as u,t as g,F as p,p as y,r as I,i as q,d as N,q as S,b as C,m as _}from"./index-DXBiOaP8.js";import{u as j}from"./group_chat-t0rLMliE.js";import{N as w}from"./NoData-Cz5gNT8B.js";function x(m){return k({url:"/request",method:"get",params:m})}function R(m){return k({url:"/request",method:"post",data:m})}function L(m){return k({url:"/grouprequest",method:"get",params:m})}const E={class:"request-card-container"},T={key:0,class:"avatar"},U=["src"],F={class:"info"},H=["title"],V=["title"],G={class:"state"},B={key:0,class:"wait-container"},D={key:1,class:"btns"},P={class:"common"},z={__name:"RequestCard",props:{avatar:{default:null,type:String||null},id:Number||String,conment:String,username:String,status:Number,userType:Number,sendId:Number,receiveId:Number},emits:["handleClickEmit"],setup(m,{emit:l}){h();const t=m,s=l;async function f(v,o,d){const r={status:v,id:o,receiveId:t.receiveId,sendId:t.sendId};d&&(r.conment=d);const{data:a}=await R(r);a.code===200&&(alert(a.message),s("handleClickEmit",r));const n={type:3,status:v,receiveId:t.receiveId,sendId:t.sendId};$.emit("send_notify",n)}return(v,o)=>(i(),c("div",E,[t.avatar?(i(),c("div",T,[e("img",{src:t.avatar,alt:"申请者照片"},null,8,U)])):u("",!0),e("div",F,[e("h3",{title:t.username},g(t.username),9,H),e("p",{class:"conment",title:t.conment},g(t.conment),9,V)]),e("div",G,[t.status==0?(i(),c(p,{key:0},[t.userType==1?(i(),c("div",B,o[2]||(o[2]=[e("div",{class:"font_icon"},[e("svg",{class:"icon","aria-hidden":"true"},[e("use",{"xlink:href":"#icon-dengdai"})])],-1),e("strong",{class:"wait"},"待验证",-1)]))):u("",!0),t.userType==2?(i(),c("div",D,[e("button",{class:"button reject",type:"button",title:"拒绝",onClick:o[0]||(o[0]=d=>f(1,t.id))},"拒绝"),e("button",{class:"button",type:"button",title:"同意",onClick:o[1]||(o[1]=d=>f(2,t.id,t.conment))},"同意")])):u("",!0)],64)):u("",!0),e("div",P,[t.status==1?(i(),c(p,{key:0},[o[3]||(o[3]=e("div",{class:"font_icon"},[e("svg",{class:"icon","aria-hidden":"true"},[e("use",{"xlink:href":"#icon-shibai"})])],-1)),o[4]||(o[4]=e("strong",{class:"reject"},"已拒绝",-1))],64)):u("",!0),t.status==2?(i(),c(p,{key:1},[o[5]||(o[5]=e("div",{class:"font_icon"},[e("svg",{class:"icon","aria-hidden":"true"},[e("use",{"xlink:href":"#icon-chenggong"})])],-1)),o[6]||(o[6]=e("strong",{class:"agree"},"已同意",-1))],64)):u("",!0)])])]))}},M=b(z,[["__scopeId","data-v-4185219f"]]),A={class:"request-card-container"},J={key:0,class:"avatar"},K=["src"],O={class:"info"},Q=["title"],W=["title"],X={class:"state"},Y={key:0,class:"btns"},Z={key:1,class:"wait-container"},ee={class:"common"},te={__name:"GroupRequestCard",props:{avatar:{default:null,type:String||null},id:Number,joinId:Number||String,conment:String,username:String,status:Number,userType:Number,sendId:Number,receiveId:Number,handleUsername:String||null,canHandle:{default:null,type:Number||null},roomId:Number||String,roomName:String},emits:["handleClickEmit"],setup(m,{emit:l}){const t=h(),s=m,f=l;async function v(o){const d={status:o,conment:s.conment,joinId:s.joinId,roomId:s.roomId,handleId:t.user.info.id},{data:r}=await j(d);if(r.code===200){alert(r.message);const a={id:s.id,status:o};f("handleClickEmit",a)}}return(o,d)=>(i(),c("div",A,[s.avatar?(i(),c("div",J,[e("img",{src:s.avatar,alt:"申请者照片"},null,8,K),e("span",null,"群名:"+g(s.roomName),1)])):u("",!0),e("div",O,[e("h3",{title:s.username},g(s.username),9,Q),e("p",{class:"conment",title:s.conment},g(s.conment),9,W)]),e("div",X,[s.status==1?(i(),c(p,{key:0},[s.canHandle==1?(i(),c("div",Y,[e("button",{class:"button reject",type:"button",title:"拒绝",onClick:d[0]||(d[0]=r=>v(3,s.joinId))},"拒绝"),e("button",{class:"button",type:"button",title:"同意",onClick:d[1]||(d[1]=r=>v(2,s.joinId,s.conment))},"同意")])):(i(),c("div",Z,d[2]||(d[2]=[e("div",{class:"font_icon"},[e("svg",{class:"icon","aria-hidden":"true"},[e("use",{"xlink:href":"#icon-dengdai"})])],-1),e("strong",{class:"wait"},"待确认",-1)])))],64)):u("",!0),e("div",ee,[s.status==3?(i(),c(p,{key:0},[d[3]||(d[3]=y('<div class="inner" data-v-de69bc90><div class="font_icon" data-v-de69bc90><svg class="icon" aria-hidden="true" data-v-de69bc90><use xlink:href="#icon-shibai" data-v-de69bc90></use></svg></div><strong class="reject" data-v-de69bc90>已拒绝</strong></div>',1)),e("p",null,"处理人:"+g(s.handleUsername),1)],64)):u("",!0),s.status==2?(i(),c(p,{key:1},[d[4]||(d[4]=y('<div class="inner" data-v-de69bc90><div class="font_icon" data-v-de69bc90><svg class="icon" aria-hidden="true" data-v-de69bc90><use xlink:href="#icon-chenggong" data-v-de69bc90></use></svg></div><strong class="agree" data-v-de69bc90>已同意</strong></div>',1)),e("p",null,"处理人:"+g(s.handleUsername),1)],64)):u("",!0)])])]))}},se=b(te,[["__scopeId","data-v-de69bc90"]]),ne={class:"container"},ae={key:0,class:"datalist"},oe={key:1,class:"datalist"},re={__name:"RequestListView",setup(m){const l=h(),t=I([]),s=I(1);q(async()=>{const r={id:l.user.info.id};await o(r)});function f(r){t.value.forEach(a=>{a.id==r.id&&(a.status=r.status,a.handleUsername=l.user.info.username)})}async function v(r){if(s.value=r,r===1){const a={id:l.user.info.id};await o(a);return}if(r===2){const a={joinId:l.user.info.id};await d(a);return}}async function o(r){const{data:a}=await x(r),{data:n}=a;a.code===200&&(t.value=n)}async function d(r){const{data:a}=await L(r),{data:n}=a;a.code===200&&(t.value=n)}return(r,a)=>(i(),c("div",ne,[e("p",null,[e("span",{class:N({active:s.value===1}),onClick:a[0]||(a[0]=n=>v(1))},"好友申请",2),a[2]||(a[2]=S("/")),e("span",{class:N({active:s.value===2}),onClick:a[1]||(a[1]=n=>v(2))},"群聊申请",2)]),t.value.length>0&&s.value==1?(i(),c("div",ae,[(i(!0),c(p,null,C(t.value,n=>(i(),_(M,{key:n.id,id:n.id,conment:n.conment,receiveId:n.receiveId,sendId:n.sendId,userType:n.userType,avatar:n.avatar,username:n.username,status:n.status,onHandleClickEmit:f},null,8,["id","conment","receiveId","sendId","userType","avatar","username","status"]))),128))])):u("",!0),t.value.length>0&&s.value==2?(i(),c("div",oe,[(i(!0),c(p,null,C(t.value,n=>(i(),_(se,{key:n.id,id:n.id,conment:n.conment,roomName:n.roomName,canHandle:n.canHandle,handleUsername:n.handleUsername,joinId:n.joinId,roomId:n.roomId,avatar:n.avatar,status:n.status,onHandleClickEmit:f},null,8,["id","conment","roomName","canHandle","handleUsername","joinId","roomId","avatar","status"]))),128))])):u("",!0),t.value.length==0?(i(),_(w,{key:2,class:"no-data"})):u("",!0)]))}},le=b(re,[["__scopeId","data-v-8dd663cf"]]);export{le as default};
