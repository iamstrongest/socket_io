import{u as N,r as v,w as S,h as B,o as i,c as d,a as s,l as D,v as T,d as k,e as h,F as V,b,t as p,f as _,m as E,i as j,j as M,k as C,R as U}from"./index-DXBiOaP8.js";import{_ as x,u as I,c as F,s as y}from"./_plugin-vue_export-helper-D_52YD_W.js";import{u as A}from"./chat-C1OJTjRb.js";import{N as O}from"./NoData-Cz5gNT8B.js";import"./group_chat-t0rLMliE.js";const G={class:"search"},H=["onClick"],W=["src"],X={class:"right-info"},q=["title"],J=["title"],K=["title"],P={__name:"Room",setup($){const f=N(),r=I(),t=A(),l=v(),m=v(),c=v(""),a=v([]);S(c,(n,o)=>{n.length===0?a.value=t.roomList:a.value=t.roomList.filter(e=>e.username?e.username.indexOf(n)!==-1:e.roomName.indexOf(n)!==-1)}),B(async()=>{const n={id:r.user.info.id};await t.getSingleRoomDataList(n),await t.getGroupRoomLastChatDataList(n),a.value=t.roomList});function w(n,o,e,L){let u=F[n].path;e&&n==1&&(u=`${u}/${e}?receiveId=${L}`),e&&n==2&&(u=`${u}/${e}`),t.updateChatActive(o),t.updateActiveRoomId(e),f.push(u)}function z(n){n.preventDefault(),window.addEventListener("mousemove",R),window.addEventListener("mouseup",g)}function R(n){const o=n.clientX-l.value.getBoundingClientRect().left;o>150&&o<300&&(l.value.style.width=o+"px")}function g(){window.removeEventListener("mousemove",R),window.removeEventListener("mouseup",g)}return(n,o)=>(i(),d("div",{class:"chatList-container",ref_key:"resizableRef",ref:l},[o[4]||(o[4]=s("h3",null,"聊天记录",-1)),s("div",{class:"resizer",ref_key:"resizerRef",ref:m,onMousedown:z},null,544),s("div",G,[D(s("input",{type:"text",name:"search",id:"search",placeholder:"输入昵称","onUpdate:modelValue":o[0]||(o[0]=e=>c.value=e)},null,512),[[T,c.value]]),o[2]||(o[2]=s("div",{class:"icons"},[s("svg",{class:"icon","aria-hidden":"true"},[s("use",{"xlink:href":"#icon-sousuo"})])],-1))]),s("div",{class:k(["new-friends hover",{active:h(t).chatActive==-1}]),onClick:o[1]||(o[1]=e=>w(-1,-1))},o[3]||(o[3]=[s("i",null,[s("svg",{class:"icon","aria-hidden":"true"},[s("use",{"xlink:href":"#icon-xindehaoyou"})])],-1),s("strong",null,"新的申请",-1)]),2),a.value.length>0?(i(!0),d(V,{key:0},b(a.value,e=>(i(),d("div",{class:k(["room-list hover",{active:h(t).chatActive==e.roomId}]),key:e.roomId,onClick:L=>w(e.chatRoomType,e.roomId,e.roomId,e.showUserId)},[s("div",null,[s("img",{src:e.avatar,alt:"用户头像",title:"用户头像"},null,8,W)]),s("div",X,[e.chatRoomType==1?(i(),d("strong",{key:0,title:e.username},p(e.username),9,q)):_("",!0),e.chatRoomType==2?(i(),d("strong",{key:1,title:e.roomName},p(e.roomName),9,J)):_("",!0),s("span",{title:e.lastChat},p(e.conment),9,K)])],10,H))),128)):(i(),E(O,{key:1,class:"no-data"}))],512))}},Q=x(P,[["__scopeId","data-v-8c7e487d"]]),Y={key:0,class:"chat-container"},Z={class:"chat-container-right"},ee={__name:"ChatView",setup($){const f=I(),r=A();return j(()=>{y.on("single_receive",t=>{r.activeRoomId===t.roomId&&r.addAfterChat(t),r.updateRoomList({roomId:t.roomId,conment:t.conment,createdAt:t.createdAt})}),y.on("group_receive",t=>{r.activeRoomId===t.roomId&&r.addAfterChat(t),r.updateRoomList({roomId:t.roomId,conment:t.conment,createdAt:t.createdAt})})}),M(()=>{r.resetRoomList(),r.resetChatList()}),(t,l)=>{var m,c,a;return(a=(c=(m=h(f))==null?void 0:m.user)==null?void 0:c.info)!=null&&a.id?(i(),d("div",Y,[C(Q),s("div",Z,[C(h(U))])])):_("",!0)}}},ie=x(ee,[["__scopeId","data-v-5cd130ad"]]);export{ie as default};
