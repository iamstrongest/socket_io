import{u as N,r as v,w as S,h as U,o as i,c as d,a as s,l as B,v as D,d as k,e as f,F as T,b as V,t as p,f as _,m as b,i as E,j,k as C,R as M}from"./index-DVw92pm9.js";import{_ as I,u as x,c as F,s as y}from"./_plugin-vue_export-helper-DsrsFqtt.js";import{u as A}from"./chat-BlAwU8ry.js";import{N as G}from"./NoData-DaqeYu2V.js";import"./group_chat-CzpvJGJe.js";const O={class:"search"},H=["onClick"],W=["src"],X={class:"right-info"},q=["title"],J=["title"],K=["title"],P={__name:"Room",setup($){const h=N(),r=x(),t=A(),u=v(),m=v(),c=v(""),a=v([]);S(c,(n,o)=>{n.length===0?a.value=t.roomList:a.value=t.roomList.filter(e=>e.username?e.username.indexOf(n)!==-1:e.roomName.indexOf(n)!==-1)}),U(async()=>{const n={id:r.user.info.id};await t.getSingleRoomDataList(n),await t.getGroupRoomLastChatDataList(n),a.value=t.roomList});function R(n,o,e,L){let l=F[n].path;e&&n==1&&(l=`${l}/${e}?receiveId=${L}`),e&&n==2&&(l=`${l}/${e}`),t.updateChatActive(o),t.updateActiveRoomId(e),h.push(l)}function z(n){n.preventDefault(),window.addEventListener("mousemove",w),window.addEventListener("mouseup",g)}function w(n){const o=n.clientX-u.value.getBoundingClientRect().left;o>150&&o<300&&(u.value.style.width=o+"px")}function g(){window.removeEventListener("mousemove",w),window.removeEventListener("mouseup",g)}return(n,o)=>(i(),d("div",{class:"chatList-container",ref_key:"resizableRef",ref:u},[o[4]||(o[4]=s("h3",null,"聊天记录",-1)),s("div",{class:"resizer",ref_key:"resizerRef",ref:m,onMousedown:z},null,544),s("div",O,[B(s("input",{type:"text",name:"search",id:"search",placeholder:"输入昵称","onUpdate:modelValue":o[0]||(o[0]=e=>c.value=e)},null,512),[[D,c.value]]),o[2]||(o[2]=s("div",{class:"icons"},[s("svg",{class:"icon","aria-hidden":"true"},[s("use",{"xlink:href":"#icon-sousuo"})])],-1))]),s("div",{class:k(["new-friends hover",{active:f(t).chatActive==-1}]),onClick:o[1]||(o[1]=e=>R(-1,-1))},o[3]||(o[3]=[s("i",null,[s("svg",{class:"icon","aria-hidden":"true"},[s("use",{"xlink:href":"#icon-xindehaoyou"})])],-1),s("strong",null,"新的申请",-1)]),2),a.value.length>0?(i(!0),d(T,{key:0},V(a.value,e=>(i(),d("div",{class:k(["room-list hover",{active:f(t).chatActive==e.roomId}]),key:e.roomId,onClick:L=>R(e.chatRoomType,e.roomId,e.roomId,e.showUserId)},[s("div",null,[s("img",{src:e.avatar,alt:"用户头像",title:"用户头像"},null,8,W)]),s("div",X,[e.chatRoomType==1?(i(),d("strong",{key:0,title:e.username},p(e.username),9,q)):_("",!0),e.chatRoomType==2?(i(),d("strong",{key:1,title:e.roomName},p(e.roomName),9,J)):_("",!0),s("span",{title:e.lastChat},p(e.conment),9,K)])],10,H))),128)):(i(),b(G,{key:1,class:"no-data"}))],512))}},Q=I(P,[["__scopeId","data-v-6a70d061"]]),Y={key:0,class:"chat-container"},Z={class:"chat-container-right"},ee={__name:"ChatView",setup($){const h=x(),r=A();return E(()=>{y.on("single_receive",t=>{r.activeRoomId===t.roomId&&r.addAfterChat(t),r.updateRoomList({roomId:t.roomId,conment:t.conment,createdAt:t.createdAt})}),y.on("group_receive",t=>{r.activeRoomId===t.roomId&&(r.addAfterChat(t),t.deleteId&&r.deleteGroupRoomUserFn(t.deleteId),t.addUser&&r.addUserAfter(t)),r.updateRoomList({roomId:t.roomId,conment:t.conment,createdAt:t.createdAt})})}),j(()=>{r.resetRoomList(),r.resetChatList()}),(t,u)=>{var m,c,a;return(a=(c=(m=f(h))==null?void 0:m.user)==null?void 0:c.info)!=null&&a.id?(i(),d("div",Y,[C(Q),s("div",Z,[C(f(M))])])):_("",!0)}}},ie=I(ee,[["__scopeId","data-v-a6df357f"]]);export{ie as default};
